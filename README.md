The current code will train and work, but it's convergence is slower because it starts off in a not great spot in the weight space. Please see nanoGPT model.py for #init all weights comment and especially how it calls the _init_weights function. Even more sadly, the code in the repo is a bit different in how it names and stores the various modules, so it's not possible to directly copy paste this code here. My current plan is to publish a suppelemtary video lecture and cover these parts, then I will also push the exact code changes to this repo.